<!--
*  applicationform.html
*
 Version 2
*
* 11/05/2024   
*	
* @author Emma Carroll, Student ID x20226314
*
*-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Application Form</title>
    <!-- CSS -->
    <link rel="stylesheet" href="login.css" />
    <link rel="stylesheet" href="navbar.css" />
    <link rel="stylesheet" href="footer.css" />
    <link rel="stylesheet" href="header.css" />
    <!--bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
 
</head>
<body>
    <!-- Navbar  -->
    <header>
        <container id="nav-bar">
            <nav class="navbar navbar-expand-lg bg-body-tertiary">
                <div class="container-fluid">
                    <div class="container">
                         <a class="navbar-brand" href="#"><img src="images/Logo.png"></a>
                    </div>
                    <div class="collapse navbar-collapse" id="navbarNavDropdown">
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item"><a class="nav-link active" aria-current="page" href="home.html">Home</a></li>
                            <li class="nav-item"><a class="nav-link" href="Q&A.html">Q&A</a></li>
                            <li class="nav-item"><a class="nav-link" href="LandListing.html">Listed Land</a></li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Donated Items</a>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="SeedaItemListing.html">Seeds</a></li>
                                        <li><a class="dropdown-item" href="PlantItemListing.html">Plants</a></li>
                                        <li><a class="dropdown-item" href="TreesItemListings.html">Trees</a></li>
                                        <li><a class="dropdown-item" href="ToolsItemListing.html">Tools</a></li>
                                    </ul>
                            </li>
                            <li class="nav-item">
                                <form class="d-flex">
                                  <button class="btn btn-outline-success" type="button" id="signoutbutton">Sign Out</button>
                                </form>
                              </li>
                        </ul>
                    </div>
                </div>
              </nav>
          </container>
      </header>
       <!-- Ad block -->
    <div style="max-width: 30%; margin:auto;">
        <div class="container-fluid ">
            <div class="advertisment-box">
                <img src="images/addspace.PNG"  class="img-fluid" alt="Responsive image">
            </div>
        </div>
    </div>
    <div class="container">
            <div className='application-form'>
                <h2>Application Form</h2>
                </br>
                <!--form submission-->
                <form id="applicationForm" iclass="App-form">
                    <div class='apllication-details'>
                        <label class="form-label"><strong>Sending Form to Email Address</strong></label>
                        <input class="form-control" type='email' id="email" name="email" />
                    </br>
                    </br>
                        <label class="form-label"><strong>Application to recieve the following:</strong></label>
                        <input class="form-control" type='donationitem' id="donationitem" name="donationitem" placeholder="Enter Item Description"/>
                    </br>
                    </br>
                        <label class="form-label"><strong>Full Name</strong></label>
                        <input class="form-control" type='name' id="username" name="username" placeholder="Enter your full name"/>
                    </br>
                    </br>
                        <label class="form-label"><strong>Email</strong></label>
                        <input class="form-control" type='useremail' id="useremail" name="useremail" placeholder="Enter email you wish to be contacted from" />
                    </br>
                    </br>
                        <label class="form-label"><strong>Phone Number</strong></label>
                        <input class="form-control" type='phone' id="phone" name="phone" placeholder="Enter phone number you wish to be contacted from"/>
                    </br>
                    </br>
                        <label class="form-label"><strong>Available Timeframe to Pickup Donation</strong></label>
                        <textarea class="form-control" id="timeframe" name="timeframe" rows="3" cols="100" placeholder="Enter timeframe you are available to work"></textarea>                  
                    </br>
                    </br>
                        <label class="form-label"><strong>Do you grant permission for donator to contact you via email</strong></label>
                        <input class="form-control" type='permission1' id="permission1" name="permission1"placeholder='Type yes or no' />
                    </br>
                    </br>
                        <label class="form-label"><strong>Do you grant permission for donator to contact you via phone number</strong></label>
                        <input class="form-control" type='permission2' id="permission2" name="permission2" placeholder='Type yes or no' />
                    </div>
                </div>
                </br>
                <div class="button-container">
                    <button class="submitapp" type='submit'><strong>Submit</strong></button>
                </div>
                </br>
                </form>
            </div>
            <!--footer-->
        </br>
    </br>
            <footer>
                <span class="nci">&copy; &nbsp;NCI | All rights reservered </span>
            </footer>
            <!--bootstrap-->
              <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>            

              <script>
                //retrieve the applicant email from session storage
                const applicantEmail=JSON.parse(sessionStorage.getItem("applicant-email"));
                 //check if the applicant email exists in session storage
                if (!applicantEmail){
                    console.error("Applicant email not found");
                }

                //set the value of the email input in the application form to the retrieved applicant email
                document.getElementById('email').value = applicantEmail;

                document.getElementById('applicationForm').addEventListener('submit',function(event){
                    event.preventDefault();//pervents the default form submission
                    //retrieve values from form fields
                    const emailRecipient = document.getElementById('email').value;
                    const emailSubject = "GCP application";
                    const emailBody = `
                        Applying for: ${document.getElementById('donationitem').value}
                        Full Name: ${document.getElementById('username').value}
                        Email: ${document.getElementById('useremail').value}
                        Phone Number: ${document.getElementById('phone').value}
                        Available Timeframe to Work: ${document.getElementById('timeframe').value}
                        Permission Granted for Donator to Contact Applicant Via Email: ${document.getElementById('permission1').value}
                        Permission Granted for Donator to Contact Applicant Via Phone Number: ${document.getElementById('permission2').value}
                        
                    `;
                    //link to default email to make a email message with a pre-filled email recipient, subject and body
                    window.location.href="mailto:"+encodeURIComponent(emailRecipient)+"?subject="+encodeURIComponent(emailSubject)+"&body="+encodeURIComponent(emailBody);
                });
              </script>

<script>
    //check user credentials on page load
    const UserCreds = JSON.parse(sessionStorage.getItem("user-creds"));
    const UserInfo = JSON.parse(sessionStorage.getItem("user-info"));
  
    const checkCred = () => {
      if (!UserCreds) window.location.href = 'login.html';//if  user credentials not found bring to login.html
    };
  
    const signout = () => {
      sessionStorage.clear();//clear session storage 
      window.location.href = 'login.html';//bring to login.html
    };
  
    window.addEventListener('load', checkCred);
    document.getElementById('signoutbutton').addEventListener('click', signout);
  </script>
        </body>
</html>